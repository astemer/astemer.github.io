var c=!1,e=null,g=0,h=0,k={x:0,y:0},m={h:{angle:0,a:0},i:0,f:{b:0,c:0},g:{b:0,c:0}},n,p,q,r=0,t=1,u=0,v=0,w=0,x=[{x:0,y:0}],y=0,z=!0,A={x:0,y:0},B=!1,C=!0,D="eng";function E(a){switch(a.code){case a.PERMISSION_DENIED:alert("User did not share geolocation data");break;case a.POSITION_UNAVAILABLE:alert("Could not detect current position");break;case a.TIMEOUT:alert("Retrieving position timedout");break;default:alert("Unknown error")}}
function F(a){var b=a.coords.latitude,d=a.coords.longitude;g=b;h=d;a={x:0,y:0};b=G(b,d);angleDelta=m.h.angle-b.angle;angle=m.h.angle-angleDelta;dist=b.a*m.i;a.x=Math.cos(angle)*dist;a.y=Math.sin(angle)*dist;k=a;document.getElementById("current_location").value=g+", "+h;dist=H(k.x,k.y,x[x.length-1].x,x[x.length-1].y);dist>n&&x.push({x:k.x,y:k.y});1E3<x.length&&x.shift()}function I(a){var b={x:0,y:0};b.x=a.x*t+u;b.y=a.y*t+v;return b}
function J(a){q.beginPath();a=I(a);q.arc(a.x,a.y,3,0,2*Math.PI);q.stroke()}
function K(){q.clearRect(0,0,p.width,p.height);q.beginPath();q.closePath();q.drawImage(map_image,0,0,map_image.width,map_image.height,u,v,map_image.width*t,map_image.height*t);0!=C&&(q.lineWidth=1,q.strokeStyle="red",x.forEach(J));var a=I(k);if(a.x>p.width||0>a.x||a.y>p.height||0>a.y)z=!1;else if(z=!0,0!=b||0!=d){var b=a.x,d=a.y;a=30;0==y%2&&(a-=a/4);var f=2*a/3,l=a/3;q.beginPath();q.lineWidth=5;q.strokeStyle="red";q.arc(b,d,a-l,0,2*Math.PI);q.moveTo(b-a,d);q.lineTo(b-a+f,d);q.moveTo(b+a,d);q.lineTo(b+
a-f,d);q.moveTo(b,d-a,b);q.lineTo(b,d-a+f);q.moveTo(b,d+a);q.lineTo(b,d+a-f);q.stroke();q.beginPath();q.lineWidth=2;q.strokeStyle="white";q.arc(b,d,a-l,0,2*Math.PI);q.moveTo(b-a,d);q.lineTo(b-a+f,d);q.moveTo(b+a,d);q.lineTo(b+a-f,d);q.moveTo(b,d-a,b);q.lineTo(b,d-a+f);q.moveTo(b,d+a);q.lineTo(b,d+a-f);q.stroke()}1!=z&&(q.strokeStyle=0==y%4?"white":"red",q.font="20px Arial",q.strokeText("You are not located on this map area...",20,60));0==A.x&&0==A.y||0==B||(q.beginPath(),q.lineWidth=2,q.strokeStyle=
"black",canvasCords=I(k),q.moveTo(canvasCords.x,canvasCords.y),q.lineTo(A.x,A.y),q.stroke(),q.beginPath(),q.arc(A.x,A.y,7,0,2*Math.PI),q.fill(),q.font="20px Arial",b={x:0,y:0},b.x=(A.x-u)/t,b.y=(A.y-v)/t,lastTouchMapCords=b,b=H(lastTouchMapCords.x,lastTouchMapCords.y,k.x,k.y),b=0==m.i?0:b/m.i,b=b.toFixed(3),q.strokeText(b+" Km",A.x,A.y-30),q.stroke())}function L(){y+=1;1E5<y&&(y=0);K()}function H(a,b,d,f){a=d-a;b=f-b;return Math.sqrt(a*a+b*b)}
function G(a,b){var d=m.f.b,f=m.f.c,l={angle:0,a:0};l.a=M(d,f,a,b);var R=l.a;d=M(d,f,a,f);l.angle=Math.asin(d/R);JSON.stringify(l);return l}function M(a,b,d,f){var l=Math.PI/180*(d-a);b=Math.PI/180*(f-b);a=Math.sin(l/2)*Math.sin(l/2)+Math.cos(Math.PI/180*a)*Math.cos(Math.PI/180*d)*Math.sin(b/2)*Math.sin(b/2);return 12742*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function N(a){var b=p.getBoundingClientRect();A.x=a.touches[0].clientX-b.left;A.y=a.touches[0].clientY-b.top}
function O(){document.getElementById("mySidenav").style.width="0";document.body.style.backgroundColor="white"}var P=window;c=c=!0;document.getElementById("current_location").value="Loading...";var Q=document.getElementById("map_data").value.split(";",7);mapTitle=Q[1];D=Q[2];m.f.b=Q[3];m.f.c=Q[4];m.g.b=Q[5];m.g.c=Q[6];document.getElementById("map_title").innerHTML=mapTitle;p=document.getElementById("map_canvas");q=p.getContext("2d");p.width=window.innerWidth;
p.height=window.innerHeight-window.innerHeight/5;map_image=new Image;map_image.src="img.jpg";
map_image.onload=function(){var a=p.width/map_image.width,b=p.height/map_image.height;t=a<b?a:b;q.drawImage(map_image,0,0,map_image.width,map_image.height,u,v,map_image.width*t,map_image.height*t);m.h=G(m.g.b,m.g.c);a=H(0,0,map_image.width,map_image.height);m.i=a/m.h.a;JSON.stringify(m);n=a/250;null==e&&(e=navigator.geolocation.watchPosition(F,E,{timeout:1E4,enableHighAccuracy:!0,maximumAge:Infinity}));setInterval(L,500)};r=0;
p.addEventListener("touchstart",function(a){N(a);w=0;r=2==a.touches.length?2:1==a.touches.length?1:0;K()},!1);p.addEventListener("touchmove",function(a){if(0!=r)if(1==r){var b=p.getBoundingClientRect(),d=a.touches[0].clientY-b.top-A.y;u+=a.touches[0].clientX-b.left-A.x;v+=d;N(a)}else 2==r&&(a=H(a.touches[0].screenX,a.touches[0].screenY,a.touches[1].screenX,a.touches[1].screenY),0!=w&&(t*=a/w,4<t?t=4:.1>t&&(t=.1)),w=a);K()},!1);p.addEventListener("touchend",function(){r=0},!1);
document.getElementById("menuOpen").onclick=function(){0!=c&&(document.getElementById("mySidenav").style.width="270px",document.body.style.backgroundColor="rgba(0,0,0,0.4)")};document.getElementById("myCloseBtn").onclick=O;var S="Show/Hide distance ruler";"heb"==D&&(S="\u05d4\u05e6\u05d2/\u05d4\u05e1\u05ea\u05e8 \u05e1\u05e8\u05d2\u05dc \u05de\u05e8\u05d7\u05e7");document.getElementById("menuItem1").innerHTML=S;document.getElementById("menuItem1").onclick=function(){B=0==B?!0:!1;O()};S="Keep screen on";
"heb"==D&&(S="\u05e9\u05de\u05d5\u05e8 \u05d0\u05ea \u05d4\u05de\u05e1\u05da \u05d3\u05dc\u05d5\u05e7");document.getElementById("menuItem2").innerHTML=S;document.getElementById("menuItem2").onclick=function(){O()};S="Show/Hide tail of locations";"heb"==D&&(S="\u05d4\u05e6\u05d2/\u05d4\u05e1\u05ea\u05e8 \u05de\u05d9\u05e7\u05d5\u05de\u05d9\u05dd \u05e7\u05d5\u05d3\u05de\u05d9\u05dd");document.getElementById("menuItem3").innerHTML=S;
document.getElementById("menuItem3").onclick=function(){C=0==C?!0:!1;O()};S="Save for Offline use";"heb"==D&&(S="\u05e9\u05de\u05d5\u05e8 \u05d0\u05ea \u05d4\u05d3\u05e3 \u05dc\u05e9\u05d9\u05de\u05d5\u05e9 \u05dc\u05dc\u05d0 \u05d0\u05d9\u05e0\u05d8\u05e8\u05e0\u05d8");document.getElementById("menuItem4").innerHTML=S;document.getElementById("menuItem4").onclick=function(){O()};P.onload=void 0;