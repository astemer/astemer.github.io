var b=!1,e=null,f=0,h=0,k={x:0,y:0},m={h:{angle:0,a:0},i:0,f:{b:0,c:0},g:{b:0,c:0}},n,p,q,r=[{x:0,y:0}],t=0,u=!0,v={x:0,y:0},w=!1,x=!0;function y(a){switch(a.code){case a.PERMISSION_DENIED:alert("User did not share geolocation data");break;case a.POSITION_UNAVAILABLE:alert("Could not detect current position");break;case a.TIMEOUT:alert("Retrieving position timedout");break;default:alert("Unknown error")}}
function z(a){var c=a.coords.latitude,d=a.coords.longitude;f=c;h=d;a={x:0,y:0};c=A(c,d);angleDelta=m.h.angle-c.angle;angle=m.h.angle-angleDelta;dist=c.a*m.i;a.x=Math.cos(angle)*dist;a.y=Math.sin(angle)*dist;k=a;document.getElementById("current_location").value=f+", "+h;u=k.x>p.width||0>k.x||k.y>p.height||0>k.y?!1:!0;dist=B(k.x,k.y,r[r.length-1].x,r[r.length-1].y);dist>n&&r.push({x:k.x,y:k.y});1E3<r.length&&r.shift()}function C(a){q.beginPath();q.arc(a.x,a.y,3,0,2*Math.PI);q.stroke()}
function D(){q.clearRect(0,0,p.width,p.height);q.beginPath();q.closePath();q.drawImage(map_image,0,0,map_image.width,map_image.height,0,0,p.width,p.height);0!=x&&(q.lineWidth=1,q.strokeStyle="red",r.forEach(C));var a=k.x,c=k.y;if(0!=a||0!=c){var d=30;0==t%2&&(d-=d/4);var g=2*d/3,l=d/3;q.beginPath();q.lineWidth=5;q.strokeStyle="red";q.arc(a,c,d-l,0,2*Math.PI);q.moveTo(a-d,c);q.lineTo(a-d+g,c);q.moveTo(a+d,c);q.lineTo(a+d-g,c);q.moveTo(a,c-d,a);q.lineTo(a,c-d+g);q.moveTo(a,c+d);q.lineTo(a,c+d-g);q.stroke();
q.beginPath();q.lineWidth=2;q.strokeStyle="white";q.arc(a,c,d-l,0,2*Math.PI);q.moveTo(a-d,c);q.lineTo(a-d+g,c);q.moveTo(a+d,c);q.lineTo(a+d-g,c);q.moveTo(a,c-d,a);q.lineTo(a,c-d+g);q.moveTo(a,c+d);q.lineTo(a,c+d-g);q.stroke()}1!=u&&(q.strokeStyle=0==t%4?"white":"red",q.font="30px Arial",q.strokeText("You are not located on this map...",20,60));0==v.x&&0==v.y||0==u||0==w||(q.beginPath(),q.lineWidth=2,q.strokeStyle="black",q.moveTo(k.x,k.y),q.lineTo(v.x,v.y),q.stroke(),q.beginPath(),q.arc(v.x,v.y,7,
0,2*Math.PI),q.fill(),q.font="20px Arial",a=B(v.x,v.y,k.x,k.y),a=0==m.i?0:a/m.i,a=a.toFixed(3),q.strokeText(a+" Km",v.x,v.y-30),q.stroke())}function E(){t+=1;1E5<t&&(t=0);D()}function B(a,c,d,g){a=d-a;c=g-c;return Math.sqrt(a*a+c*c)}function A(a,c){var d=m.f.b,g=m.f.c,l={angle:0,a:0};l.a=F(d,g,a,c);var I=l.a;d=F(d,g,a,g);l.angle=Math.asin(d/I);JSON.stringify(l);return l}
function F(a,c,d,g){var l=Math.PI/180*(d-a);c=Math.PI/180*(g-c);a=Math.sin(l/2)*Math.sin(l/2)+Math.cos(Math.PI/180*a)*Math.cos(Math.PI/180*d)*Math.sin(c/2)*Math.sin(c/2);return 12742*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function G(){document.getElementById("mySidenav").style.width="0";document.body.style.backgroundColor="white"}var H=window;b=b=!0;document.getElementById("current_location").value="Loading...";var J=document.getElementById("map_data").value.split(";",7);mapTitle=J[1];m.f.b=J[3];
m.f.c=J[4];m.g.b=J[5];m.g.c=J[6];document.getElementById("map_title").innerHTML=mapTitle;p=document.getElementById("map_canvas");q=p.getContext("2d");map_image=new Image;map_image.src="img.jpg";
map_image.onload=function(){var a=map_image.width/map_image.height;p.width=window.innerWidth;p.height=p.width/a;q.drawImage(map_image,0,0,map_image.width,map_image.height,0,0,p.width,p.height);m.h=A(m.g.b,m.g.c);a=B(0,0,p.width,p.height);m.i=a/m.h.a;JSON.stringify(m);n=a/250;null==e&&(e=navigator.geolocation.watchPosition(z,y,{timeout:1E4,enableHighAccuracy:!0,maximumAge:Infinity}));setInterval(E,500)};
p.addEventListener("mousedown",function(a){var c=p.getBoundingClientRect();v={x:a.clientX-c.left,y:a.clientY-c.top};D()},!1);p.addEventListener("touchstart",function(a){var c=p.getBoundingClientRect();v={x:a.touches[0].clientX-c.left,y:a.touches[0].clientY-c.top};D()},!1);document.getElementById("menuOpen").onclick=function(){0!=b&&(document.getElementById("mySidenav").style.width="270px",document.body.style.backgroundColor="rgba(0,0,0,0.4)")};document.getElementById("myCloseBtn").onclick=G;
document.getElementById("menuItem1").innerHTML="Show/Hide distance ruler";document.getElementById("menuItem1").onclick=function(){w=0==w?!0:!1;G()};document.getElementById("menuItem2").innerHTML="Keep screen on";document.getElementById("menuItem2").onclick=function(){G()};document.getElementById("menuItem3").innerHTML="Show/Hide tail of locations";document.getElementById("menuItem3").onclick=function(){x=0==x?!0:!1;G()};document.getElementById("menuItem4").innerHTML="Save for Offline use";
document.getElementById("menuItem4").onclick=function(){G()};H.onload=void 0;